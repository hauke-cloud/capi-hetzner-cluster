# Default values for example.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# This is to override the chart name.
nameOverride: ""
fullnameOverride: ""

# Hetzner related settings
hetzner:
  token:
    existingSecret:
      name: prod
      keys:
        hcloudToken: hcloud
        hetznerRobotPassword: robot-password
        hetznerRobotUser: robot-user
  sshKeys:
    - default-0

# Kubernetes
kubernetes:
  version: v1.32.7

# Control Planes
controlPlanes:
  image: ubuntu-24.04
  nodes: 3
  regions:
    - fsn1
  flavor:
    name: cx22
  endpoint:
    host: ""
    port: 443
  loadBalancer:
    region: fsn1
  network:
    enabled: false
  placement:
    type: spread

# Workers
workers:
  - name: worker-1
    image: ubuntu-24.04
    minNodes: 0
    maxNodes: 5
    region: fsn1
    flavor:
      name: cx22
      cpu: 2
      memory: 4Gi
      ephemeralStorage: 40Gi
      # hugepages-1Gi: 0
      # hugepages-2Mi 0
      maxPods: 120
    placement:
      type: spread

# Bootstrap
# Bootstrap the remote cluster with basic components
bootstrap:
  # Cilium remote installation
  # If enabled the Helm chart will create a Fluxv2 Helm repository and release
  # which will install Cilium via remote kubeconfig on the target cluster
  cilium:
    enabled: true
    version: 1.18.1
    repoOverrides:
      url: https://helm.cilium.io/
      interval: 5m0s
      type: default
    chartOverrides:
      name: cilium
      targetNamespace: kube-system
      interval: 5m0s
      values:
        hostFirewall:
          enabled: true
        extraArgs:
          - --direct-routing-device=eth0
        operator:
          tolerations:
            - key: "node-role.kubernetes.io/control-plane"
              operator: Exists
            - key: "node-role.kubernetes.io/master" #deprecated
              operator: Exists
            - key: "node.kubernetes.io/not-ready"
              operator: Exists
            - key: "node.cluster.x-k8s.io/uninitialized"
              operator: Exists
            - key: "node.cloudprovider.kubernetes.io/uninitialized"
              operator: Exists
      kubeConfig:
        secretRef:
          name: ""
          key: ""

  # Hetzner cloud controller manager remote installation
  # If enabled the Helm chart will create a Hetzner repository and CCM release
  # which will install the Hetzner CCM  via remote kubeconfig on the target cluster
  hetznerCCM:
    enabled: true
    version: v1.26.0
    repoOverrides:
      url: https://charts.hetzner.cloud
      interval: 5m0s
      type: default
    chartOverrides:
      name: hcloud-cloud-controller-manager
      targetNamespace: kube-system
      interval: 5m0s
      values:
        additionalTolerations:
          - key: "node.cluster.x-k8s.io/uninitialized"
            operator: Exists
      kubeConfig:
        secretRef:
          name: ""
          key: ""

  # Cluster Auto-Scaler remote installation
  # If enabled the Helm chart will create a CA repository and release
  # which will install the Cluster Auto-Scaler via remote kubeconfig on the target cluster
  autoscaler:
    enabled: true
    version: 9.50.1
    repoOverrides:
      url: https://kubernetes.github.io/autoscaler
      interval: 5m0s
      type: default
    chartOverrides:
      name: cluster-autoscaler
      interval: 5m0s
      values:
        cloudProvider: clusterapi
        clusterAPIMode: kubeconfig-incluster
        extraArgs:
          logtostderr: true
          stderrthreshold: ERROR
          v: 4
        rbac:
          additionalRules:
            - apiGroups:
                - infrastructure.cluster.x-k8s.io
              resources:
                - hcloudmachinetemplates
              verbs:
                - get
                - list
                - watch
      kubeConfig:
        secretRef:
          name: ""
          key: ""

  # Fluxv2 remote installation
  # If enabled the Helm chart will create a Fluxv2 repository and release
  # which will install the Fluxv2 via remote kubeconfig on the target cluster
  flux:
    enabled: true
    version: 9.50.1
    repoOverrides:
      url: https://github.com/fluxcd/flux2.git
      ref:
        branch: main
      interval: 5m0s
    kustomizationOverrides:
      path: ./manifests/install
      targetNamespace: flux-system
      interval: 5m0s
      prune: true
      timeout: 1m
      kubeConfig:
        secretRef:
          name: ""
          key: ""

# Network
network:
  clusterNetwork:
    podCidrBlocks:
      - 10.244.0.0/16

# Remedations
remedation:
  retryLimit: 1
  timeout: 180s
  type: Reboot

# Health checks
healthChecks:
  maxUnhealthy: 100%
  nodeStartupTimeout: 15m
  unhealhyConditions:
    - status: Unknown
      timeout: 180s
      type: Ready
    - status: "False"
      timeout: 180s
      type: Ready

nodeSelector: {}

tolerations: []

affinity: {}
